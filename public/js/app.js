"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function start(){$("#login").on("submit",login),$("#signup").on("submit",register),$(".logout").on("click",logout),getToken()?loggedInState():loggedOutState()}function loggedInState(){$(".loggedOut").hide(),$(".loggedIn").show(),mapSetup()}function loggedOutState(){$(".loggedIn").hide(),$(".loggedOut").show(),$("#map-canvas").empty()}function login(e){e.preventDefault(),$.ajax({method:"POST",url:"http://localhost:3000/api/login",data:$(this).serialize()}).done(getLoggedIn)}function register(e){e.preventDefault(),$.ajax({method:"POST",url:"http://localhost:3000/api/register",data:$(this).serialize()}).done(getLoggedIn)}function logout(e){e.preventDefault(),removeToken(),loggedOutState()}function getLoggedIn(e){e.token&&(setToken(e.token),loggedInState())}function setToken(e){return window.localStorage.setItem("token",e)}function getToken(){return window.localStorage.getItem("token")}function removeToken(){return window.localStorage.clear()}function mapSetup(){var e=document.getElementById("map-canvas");window.map=new google.maps.Map(e,mapOptions);var t={location:mapOptions.center,radius:1e3,types:["art_gallery","museum","subway_station"]};window.service=new google.maps.places.PlacesService(window.map),window.service.nearbySearch(t,nearByCallback)}function nearByCallback(e,t,a){if(t===google.maps.places.PlacesServiceStatus.OK){console.log(e.length);for(var o=0;o<e.length;o++)createMarker(e[o]),console.log(e[o]),window.service.getDetails({placeId:e[o].place_id},function(e,t){t===google.maps.places.PlacesServiceStatus.OK})}a.hasNextPage&&a.nextPage()}function createMarker(e){var t;e.types.indexOf("museum")>-1&&(t="images/museum.png"),e.types.indexOf("art_gallery")>-1&&(t="images/galleries.png"),e.types.indexOf("subway_station")>-1&&(t="images/station.png");var a=new google.maps.Marker({position:e.geometry.location,map:map,animation:google.maps.Animation.DROP,icon:t,types:e.types});markers.push(a),addInfoWindow(e,a)}function removeMarkers(e){markers.map(function(t){t.setMap(map),t.types.map(function(a){e.indexOf(a)>-1&&t.setMap(null)})})}function getDetailsCallback(e,t){t===google.maps.places.PlacesServiceStatus.OK&&console.log(e.formatted_address)}function addInfoWindow(e,t){google.maps.event.addListener(t,"click",function(){if("undefined"!=typeof infoWindow&&infoWindow.close(),e.opening_hours){var a;a=e.opening_hours.open_now?"Yes":"No"}e.iconsList=e.types.map(function(e){switch(e){case"restaurant":case"cafe":case"food":return'<i class="material-icons">restaurant</i>';case"museum":return'<i class="material-icons">account_balance</i>';case"art_gallery":return'<i class="material-icons">brush</i>'}});var o=new Set(e.iconsList);e.iconsList=[].concat(_toConsumableArray(o));var n="undefined"!=typeof e.photos?e.photos[0].getUrl({maxWidth:100,maxHeight:100}):"",i="";n&&(i+='<img class=infoImage src="'+n+'" width="100px">');var s="";a&&(s+="<p>Open now: "+a+"</p>");var l="";e.rating&&(l+="<p>Rating: "+e.rating+"</p>"),infoWindow=new google.maps.InfoWindow({content:i+" <p>"+e.iconsList.join("")+("</p>\n      <p>"+e.name+"</p> ")+s+l+(" <p>Address: "+e.vicinity+"</p>")}),infoWindow.open(map,t),map.setCenter(t.getPosition())})}function getUncheckedBoxes(){for(var e=document.getElementsByName("category"),t=[],a=0;a<e.length;a++)e[a].checked||t.push(e[a].value);removeMarkers(t),console.log(t)}$(start);var map,infoWindow,google=window.google,markers=[],mapOptions={zoom:13,center:new google.maps.LatLng(51.506178,(-.088369)),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"administrative.country",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.province",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"geometry",stylers:[{saturation:"-100"}]},{featureType:"landscape.natural.landcover",elementType:"geometry.fill",stylers:[{gamma:"1"},{lightness:"0"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"simplified"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:"-28"},{lightness:"33"}]},{featureType:"road",elementType:"labels.text",stylers:[{color:"#545454"}]},{featureType:"road",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:"-87"},{lightness:"-40"},{color:"#ffffff"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.fill",stylers:[{saturation:"-22"},{lightness:"100"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway.controlled_access",elementType:"labels.icon",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{saturation:"-56"},{lightness:"-14"},{hue:"#00dcff"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"off"}]}]};