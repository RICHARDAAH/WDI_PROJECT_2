"use strict";function start(){$("#login").on("submit",login),$("#signup").on("submit",register),$(".logout").on("click",logout),getToken()?loggedInState():loggedOutState()}function loggedInState(){$(".loggedOut").hide(),$(".loggedIn").show(),mapSetup()}function loggedOutState(){$(".loggedIn").hide(),$(".loggedOut").show(),$("#map-canvas").empty()}function login(e){e.preventDefault(),$.ajax({method:"POST",url:"http://localhost:3000/api/login",data:$(this).serialize()}).done(getLoggedIn)}function register(e){e.preventDefault(),$.ajax({method:"POST",url:"http://localhost:3000/api/register",data:$(this).serialize()}).done(getLoggedIn)}function logout(e){e.preventDefault(),removeToken(),loggedOutState()}function getLoggedIn(e){e.token&&(setToken(e.token),loggedInState())}function setToken(e){return window.localStorage.setItem("token",e)}function getToken(){return window.localStorage.getItem("token")}function removeToken(){return window.localStorage.clear()}function mapSetup(){var e=document.getElementById("map-canvas"),o={zoom:12,center:new google.maps.LatLng(51.506178,(-.088369)),mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(e,o),getGalleries()}function getGalleries(){$.get("http://localhost:3000/api/galleries").done(loopThroughGalleries)}function loopThroughGalleries(e){$.each(e.galleries,function(e,o){createMarkerForGallery(o)})}function createMarkerForGallery(e){var o=new google.maps.LatLng(e.lat,e.lng),t=new google.maps.Marker({position:o,map:map,animation:google.maps.Animation.DROP});addInfoWindowForGallery(e,t)}function addInfoWindowForGallery(e,o){google.maps.event.addListener(o,"click",function(){"undefined"!=typeof infoWindow&&infoWindow.close(),infoWindow=new google.maps.InfoWindow({content:'<img src="../'+e.img+'"><p>'+e.name+"</p>"}),infoWindow.open(map,o),map.setCenter(o.getPosition()),map.setZoom(15)})}$(start);var map,infoWindow,google=window.google;